## 虚析构函数

### 析构函数

析构函数是类的一个特殊的成员函数

1.当一个对象的生命周期结束时，系统会**自动调用析构函数**注销该对象并进行善后工作，对象自身也可以调用析构函数

2.析构函数的善后工作是：释放对象在生命期内获得的资源(如动态分配的内存，内核资源)；

3.析构函数也用来执行对象即将被撤销之前的任何操作。



### 虚析构函数实现

根据赋值兼容规则，可以用基类的指针指向派生类对象，如果使用基类型指针指向动态创建的派生类对象，由该基类指针撤销派生类对象，则必须将析构函数定义为虚函数，实现多态性，自动调用派生类析构函数，否则可能存在内存泄漏问题。

总结：在实现运行时的多态，无论其他程序员怎样调用析构函数都必须保证不出错，所以必须把析构函数定义为虚函数。

注意：类中没有虚函数，就不要把析构函数定义为虚。



### 虚析构函数意义

父类中使用了虚析构函数 , 在子类中 , 必须 覆盖父类的虚析构函数 , 并且使用相同的函数签名 ;

如果 子类 没有提供自己的 析构函数 , 则编译器会自动生成一个 析构函数

使用 虚析构函数 的目的是 确保在释放 子类 对象时正确地释放资源和调用析构函数 ;

当使用 **父类 指针**指向一个子类对象时 , 如果要通过 delete 释放该指针指向的对象 ,

**如果是正常的析构函数 , 没有使用 virtual 定义虚析构函数 , 则只会调用父类的析构函数 , 子类的析构函数不会被调用到**

虚析构函数 可以确保首**先调用子类**的析构函数 , 然**后调用父类**的析构函数

这样可以避免在释放子类对象时出现资源泄漏（子类中申请的资源**没有被正确释放**）的情况 ;

需要注意的是 , 只有在 父类的析构函数是 虚函数 时 , 子类 的析构函数才必须是虚函数 ;



当然如果父类的析构函数不是虚函数 , 则 子类 的 析构函数也可以是普通的非虚函数