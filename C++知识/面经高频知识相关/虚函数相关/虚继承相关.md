## 菱形继承

菱形继承是一种特殊的继承方式，它指的是在多个类层次结构中，两个子类（直接基类）继承同一个父类（间接基类），同时还有一个（或多个）子类同时继承这两个子类。

这种继承关系在类图中表示为菱形，因此得名菱形继承。在菱形继承的情况下，如果子类之间共享数据成员或函数成员，可能会导致复杂的多重继承问题，特别是在没有适当处理的情况下，可能会导致编译错误或运行时错误。在使用菱形继承时，建议使用虚继承来避免这些问题





## 虚继承

如果在一个派生类（D）中保留了间接基类（A）的多份同名成员，虽然可以在不同的成员变量中分别存放不同的数据，但大多数情况下这是多余的：因为保留多份成员变量不仅占用较多的存储空间，还容易产生命名冲突。假如类 A 有一个成员函数show，那么在类 D 中直接使用show 就会产生歧义，编译器不知道它究竟来自哪个直接基类下的间接基类，这样的情况如下

```c++
//间接基类
class A{
public:
     void show(){}
}

//直接基类
class B:public A{

}


//直接基类
class C:public A{
}


//派生类
class D:public B,public C{ 
}


int main(){
     C c;
     c.show();
}
```



为了解决多（重）继承时的命名冲突和冗余数据问题，C++ 提出了虚继承，使得在派生类中只保留一份间接基类的成员。



```c++
//直接基类
class B:virtual public A{
}


//直接基类
class C:virtual public A{
}
```



虚继承的目的是让某个类做出声明，承诺愿意共享它的基类。其中，这个被共享的基类就称为虚基类（Virtual Base Class），本例中的 A 就是一个虚基类。在这种机制下，不论虚基类在继承体系中出现了多少次，在派生类中都只包含一份虚基类的成员。



